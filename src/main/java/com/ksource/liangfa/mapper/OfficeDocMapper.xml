<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ksource.liangfa.mapper.OfficeDocMapper">
  <resultMap id="BaseResultMap" type="com.ksource.liangfa.domain.OfficeDoc">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    <id column="DOC_ID" jdbcType="DECIMAL" property="docId" />
    <result column="TEMPLATE_ID" jdbcType="DECIMAL" property="templateId" />
    <result column="CASE_ID" jdbcType="VARCHAR" property="caseId" />
    <result column="CREATE_USER" jdbcType="VARCHAR" property="createUser" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
    <result column="DOC_NAME" jdbcType="VARCHAR" property="docName" />
    <result column="DOC_PATH" jdbcType="VARCHAR" property="docPath" />
    <result column="IS_DEL" jdbcType="DECIMAL" property="isDel" />
    <result column="DOC_TYPE" jdbcType="VARCHAR" property="docType" />
    <result column="SEND_ORG" jdbcType="DECIMAL" property="sendOrg" />
    <result column="RECEIVE_ORG" jdbcType="DECIMAL" property="receiveOrg" />
    <result column="SEND_TIME" jdbcType="TIMESTAMP" property="sendTime" />
    <result column="CREATE_ORG" jdbcType="DECIMAL" property="createOrg" />
    <result column="DOC_NO" jdbcType="VARCHAR" property="docNo" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    DOC_ID, TEMPLATE_ID, CASE_ID, CREATE_USER, CREATE_TIME, DOC_NAME, DOC_PATH, IS_DEL, 
    DOC_TYPE, SEND_ORG, RECEIVE_ORG, SEND_TIME, CREATE_ORG, DOC_NO
  </sql>
  <select id="selectByExample" parameterType="com.ksource.liangfa.domain.OfficeDocExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from OFFICE_DOC
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from OFFICE_DOC
    where DOC_ID = #{docId,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    delete from OFFICE_DOC
    where DOC_ID = #{docId,jdbcType=DECIMAL}
  </delete>
  <delete id="deleteByExample" parameterType="com.ksource.liangfa.domain.OfficeDocExample">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    delete from OFFICE_DOC
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.ksource.liangfa.domain.OfficeDoc">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    insert into OFFICE_DOC (DOC_ID, TEMPLATE_ID, CASE_ID, 
      CREATE_USER, CREATE_TIME, DOC_NAME, 
      DOC_PATH, IS_DEL, DOC_TYPE, 
      SEND_ORG, RECEIVE_ORG, SEND_TIME, 
      CREATE_ORG, DOC_NO)
    values (#{docId,jdbcType=DECIMAL}, #{templateId,jdbcType=DECIMAL}, #{caseId,jdbcType=VARCHAR}, 
      #{createUser,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, #{docName,jdbcType=VARCHAR}, 
      #{docPath,jdbcType=VARCHAR}, #{isDel,jdbcType=DECIMAL}, #{docType,jdbcType=VARCHAR}, 
      #{sendOrg,jdbcType=DECIMAL}, #{receiveOrg,jdbcType=DECIMAL}, #{sendTime,jdbcType=TIMESTAMP}, 
      #{createOrg,jdbcType=DECIMAL}, #{docNo,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.ksource.liangfa.domain.OfficeDoc">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    insert into OFFICE_DOC
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="docId != null">
        DOC_ID,
      </if>
      <if test="templateId != null">
        TEMPLATE_ID,
      </if>
      <if test="caseId != null">
        CASE_ID,
      </if>
      <if test="createUser != null">
        CREATE_USER,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="docName != null">
        DOC_NAME,
      </if>
      <if test="docPath != null">
        DOC_PATH,
      </if>
      <if test="isDel != null">
        IS_DEL,
      </if>
      <if test="docType != null">
        DOC_TYPE,
      </if>
      <if test="sendOrg != null">
        SEND_ORG,
      </if>
      <if test="receiveOrg != null">
        RECEIVE_ORG,
      </if>
      <if test="sendTime != null">
        SEND_TIME,
      </if>
      <if test="createOrg != null">
        CREATE_ORG,
      </if>
      <if test="docNo != null">
        DOC_NO,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="docId != null">
        #{docId,jdbcType=DECIMAL},
      </if>
      <if test="templateId != null">
        #{templateId,jdbcType=DECIMAL},
      </if>
      <if test="caseId != null">
        #{caseId,jdbcType=VARCHAR},
      </if>
      <if test="createUser != null">
        #{createUser,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="docName != null">
        #{docName,jdbcType=VARCHAR},
      </if>
      <if test="docPath != null">
        #{docPath,jdbcType=VARCHAR},
      </if>
      <if test="isDel != null">
        #{isDel,jdbcType=DECIMAL},
      </if>
      <if test="docType != null">
        #{docType,jdbcType=VARCHAR},
      </if>
      <if test="sendOrg != null">
        #{sendOrg,jdbcType=DECIMAL},
      </if>
      <if test="receiveOrg != null">
        #{receiveOrg,jdbcType=DECIMAL},
      </if>
      <if test="sendTime != null">
        #{sendTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createOrg != null">
        #{createOrg,jdbcType=DECIMAL},
      </if>
      <if test="docNo != null">
        #{docNo,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.ksource.liangfa.domain.OfficeDocExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    select count(*) from OFFICE_DOC
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    update OFFICE_DOC
    <set>
      <if test="record.docId != null">
        DOC_ID = #{record.docId,jdbcType=DECIMAL},
      </if>
      <if test="record.templateId != null">
        TEMPLATE_ID = #{record.templateId,jdbcType=DECIMAL},
      </if>
      <if test="record.caseId != null">
        CASE_ID = #{record.caseId,jdbcType=VARCHAR},
      </if>
      <if test="record.createUser != null">
        CREATE_USER = #{record.createUser,jdbcType=VARCHAR},
      </if>
      <if test="record.createTime != null">
        CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.docName != null">
        DOC_NAME = #{record.docName,jdbcType=VARCHAR},
      </if>
      <if test="record.docPath != null">
        DOC_PATH = #{record.docPath,jdbcType=VARCHAR},
      </if>
      <if test="record.isDel != null">
        IS_DEL = #{record.isDel,jdbcType=DECIMAL},
      </if>
      <if test="record.docType != null">
        DOC_TYPE = #{record.docType,jdbcType=VARCHAR},
      </if>
      <if test="record.sendOrg != null">
        SEND_ORG = #{record.sendOrg,jdbcType=DECIMAL},
      </if>
      <if test="record.receiveOrg != null">
        RECEIVE_ORG = #{record.receiveOrg,jdbcType=DECIMAL},
      </if>
      <if test="record.sendTime != null">
        SEND_TIME = #{record.sendTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.createOrg != null">
        CREATE_ORG = #{record.createOrg,jdbcType=DECIMAL},
      </if>
      <if test="record.docNo != null">
        DOC_NO = #{record.docNo,jdbcType=VARCHAR},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    update OFFICE_DOC
    set DOC_ID = #{record.docId,jdbcType=DECIMAL},
      TEMPLATE_ID = #{record.templateId,jdbcType=DECIMAL},
      CASE_ID = #{record.caseId,jdbcType=VARCHAR},
      CREATE_USER = #{record.createUser,jdbcType=VARCHAR},
      CREATE_TIME = #{record.createTime,jdbcType=TIMESTAMP},
      DOC_NAME = #{record.docName,jdbcType=VARCHAR},
      DOC_PATH = #{record.docPath,jdbcType=VARCHAR},
      IS_DEL = #{record.isDel,jdbcType=DECIMAL},
      DOC_TYPE = #{record.docType,jdbcType=VARCHAR},
      SEND_ORG = #{record.sendOrg,jdbcType=DECIMAL},
      RECEIVE_ORG = #{record.receiveOrg,jdbcType=DECIMAL},
      SEND_TIME = #{record.sendTime,jdbcType=TIMESTAMP},
      CREATE_ORG = #{record.createOrg,jdbcType=DECIMAL},
      DOC_NO = #{record.docNo,jdbcType=VARCHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.ksource.liangfa.domain.OfficeDoc">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    update OFFICE_DOC
    <set>
      <if test="templateId != null">
        TEMPLATE_ID = #{templateId,jdbcType=DECIMAL},
      </if>
      <if test="caseId != null">
        CASE_ID = #{caseId,jdbcType=VARCHAR},
      </if>
      <if test="createUser != null">
        CREATE_USER = #{createUser,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="docName != null">
        DOC_NAME = #{docName,jdbcType=VARCHAR},
      </if>
      <if test="docPath != null">
        DOC_PATH = #{docPath,jdbcType=VARCHAR},
      </if>
      <if test="isDel != null">
        IS_DEL = #{isDel,jdbcType=DECIMAL},
      </if>
      <if test="docType != null">
        DOC_TYPE = #{docType,jdbcType=VARCHAR},
      </if>
      <if test="sendOrg != null">
        SEND_ORG = #{sendOrg,jdbcType=DECIMAL},
      </if>
      <if test="receiveOrg != null">
        RECEIVE_ORG = #{receiveOrg,jdbcType=DECIMAL},
      </if>
      <if test="sendTime != null">
        SEND_TIME = #{sendTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createOrg != null">
        CREATE_ORG = #{createOrg,jdbcType=DECIMAL},
      </if>
      <if test="docNo != null">
        DOC_NO = #{docNo,jdbcType=VARCHAR},
      </if>
    </set>
    where DOC_ID = #{docId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ksource.liangfa.domain.OfficeDoc">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 13 16:24:32 CST 2016.
    -->
    update OFFICE_DOC
    set TEMPLATE_ID = #{templateId,jdbcType=DECIMAL},
      CASE_ID = #{caseId,jdbcType=VARCHAR},
      CREATE_USER = #{createUser,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      DOC_NAME = #{docName,jdbcType=VARCHAR},
      DOC_PATH = #{docPath,jdbcType=VARCHAR},
      IS_DEL = #{isDel,jdbcType=DECIMAL},
      DOC_TYPE = #{docType,jdbcType=VARCHAR},
      SEND_ORG = #{sendOrg,jdbcType=DECIMAL},
      RECEIVE_ORG = #{receiveOrg,jdbcType=DECIMAL},
      SEND_TIME = #{sendTime,jdbcType=TIMESTAMP},
      CREATE_ORG = #{createOrg,jdbcType=DECIMAL},
      DOC_NO = #{docNo,jdbcType=VARCHAR}
    where DOC_ID = #{docId,jdbcType=DECIMAL}
  </update>
  
  <!-- ============================================================================================== -->
  	<resultMap extends="BaseResultMap" id="BaseResultMapExt" type="com.ksource.liangfa.domain.OfficeDoc">
  		 <result column="SEND_ORG_NAME" jdbcType="VARCHAR" property="sendOrgName" />
  		 <result column="RECEIVE_ORG_NAME" jdbcType="VARCHAR" property="receiveOrgName" />
  		 <result column="CREATE_ORG_NAME" jdbcType="VARCHAR" property="createOrgName" />
  	</resultMap>
  	
  	<select id="getPaginationList" parameterType="java.util.Map" resultMap="BaseResultMapExt">
	SELECT D.DOC_ID,D.TEMPLATE_ID,D.CASE_ID,D.CREATE_USER,D.CREATE_TIME,D.DOC_NAME,D.DOC_PATH,D.DOC_TYPE,D.SEND_ORG, D.RECEIVE_ORG,D.CREATE_ORG,
		(SELECT ORG_NAME FROM ORGANISE WHERE ORG_CODE = SEND_ORG) AS SEND_ORG_NAME,
		(SELECT ORG_NAME FROM ORGANISE WHERE ORG_CODE = RECEIVE_ORG) AS RECEIVE_ORG_NAME,
		(SELECT ORG_NAME FROM ORGANISE WHERE ORG_CODE = CREATE_ORG)AS CREATE_ORG_NAME
	       FROM OFFICE_DOC d
	      <where>
			<if test="docName != null">
				and DOC_NAME like '%'|| #{docName}||'%'
			</if>
			<if test="startTime != null and startTime!='' ">
				   AND CREATE_TIME &gt;= #{startTime,jdbcType=TIMESTAMP}
			</if>
			<if test="endTime != null and endTime!='' ">
				 <![CDATA[
				     and  CREATE_TIME  < (#{endTime,jdbcType=TIMESTAMP} +   interval   '1'  day)
				 	]]>
			</if>
			</where>
		order by create_time desc
	</select>

	<select id="getPaginationCount" parameterType="java.util.Map" resultType="java.lang.Integer">
	SELECT COUNT(1) FROM OFFICE_DOC
	     <where>
			<if test="docName != null">
				and DOC_NAME like '%'|| #{docName}||'%'
			</if>
			<if test="startTime != null and startTime!='' ">
				AND CREATE_TIME &gt;= #{startTime,jdbcType=TIMESTAMP}
			</if>
			<if test="endTime != null and endTime!='' ">
				 <![CDATA[
				    and  CREATE_TIME  < (#{endTime,jdbcType=TIMESTAMP} +   interval   '1'  day)
				 	]]>
			</if>
		</where>
	</select>
	
	
	<resultMap id="bulianDocMap" type="com.ksource.liangfa.domain.OfficeDoc">
  		 <result column="DOC_ID" jdbcType="DECIMAL" property="docId" />
  		 <result column="DOC_NO" jdbcType="VARCHAR" property="docNo" />
  		 <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
  	</resultMap>
  	
  	<select id="getMaxBulianDocNoByCaseId" parameterType="java.util.Map" resultMap="bulianDocMap">
	SELECT max(doc_id) as doc_id,max(create_time) as create_time,max(doc_no) as doc_no
	       FROM OFFICE_DOC 
	      <where>
			<if test="docType != null">
				and DOC_TYPE=#{docType}
			</if>
			<if test="caseId != null">
				   AND CASE_ID= #{caseId}
			</if>
			</where>
	</select>
	<select id="getDocByCaseId" resultMap="BaseResultMap">
		select * from OFFICE_DOC where DOC_TYPE=#{docType} AND CASE_ID= #{caseId}
	</select>
</mapper>