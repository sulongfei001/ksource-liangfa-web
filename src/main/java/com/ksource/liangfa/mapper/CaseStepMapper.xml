<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ksource.liangfa.mapper.CaseStepMapper">
  <resultMap id="BaseResultMap" type="com.ksource.liangfa.domain.CaseStep">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    <id column="STEP_ID" jdbcType="DECIMAL" property="stepId" />
    <result column="STEP_NAME" jdbcType="VARCHAR" property="stepName" />
    <result column="CASE_ID" jdbcType="VARCHAR" property="caseId" />
    <result column="TASK_INST_ID" jdbcType="VARCHAR" property="taskInstId" />
    <result column="TASK_DEF_ID" jdbcType="VARCHAR" property="taskDefId" />
    <result column="PROC_INST_ID" jdbcType="VARCHAR" property="procInstId" />
    <result column="PROC_DEF_ID" jdbcType="VARCHAR" property="procDefId" />
    <result column="PROC_DEF_KEY" jdbcType="VARCHAR" property="procDefKey" />
    <result column="CASE_STATE" jdbcType="VARCHAR" property="caseState" />
    <result column="START_DATE" jdbcType="TIMESTAMP" property="startDate" />
    <result column="END_DATE" jdbcType="TIMESTAMP" property="endDate" />
    <result column="ASSIGN_PERSON" jdbcType="VARCHAR" property="assignPerson" />
    <result column="FORM_DEF_ID" jdbcType="DECIMAL" property="formDefId" />
    <result column="TASK_ACTION_ID" jdbcType="DECIMAL" property="taskActionId" />
    <result column="TASK_ACTION_NAME" jdbcType="VARCHAR" property="taskActionName" />
    <result column="TASK_TYPE" jdbcType="DECIMAL" property="taskType" />
    <result column="ACTION_TYPE" jdbcType="DECIMAL" property="actionType" />
    <result column="TARGET_TASK_DEF_ID" jdbcType="VARCHAR" property="targetTaskDefId" />
    <result column="TARGET_ORG_TYPE" jdbcType="VARCHAR" property="targetOrgType" />
    <result column="TARGET_ORG_ID" jdbcType="DECIMAL" property="targetOrgId" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    STEP_ID, STEP_NAME, CASE_ID, TASK_INST_ID, TASK_DEF_ID, PROC_INST_ID, PROC_DEF_ID, 
    PROC_DEF_KEY, CASE_STATE, START_DATE, END_DATE, ASSIGN_PERSON, FORM_DEF_ID, TASK_ACTION_ID, 
    TASK_ACTION_NAME, TASK_TYPE, ACTION_TYPE, TARGET_TASK_DEF_ID, TARGET_ORG_TYPE, TARGET_ORG_ID
  </sql>
  <select id="selectByExample" parameterType="com.ksource.liangfa.domain.CaseStepExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from CASE_STEP
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    select 
    <include refid="Base_Column_List" />
    from CASE_STEP
    where STEP_ID = #{stepId,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    delete from CASE_STEP
    where STEP_ID = #{stepId,jdbcType=DECIMAL}
  </delete>
  <delete id="deleteByExample" parameterType="com.ksource.liangfa.domain.CaseStepExample">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    delete from CASE_STEP
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.ksource.liangfa.domain.CaseStep">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    insert into CASE_STEP (STEP_ID, STEP_NAME, CASE_ID, 
      TASK_INST_ID, TASK_DEF_ID, PROC_INST_ID, 
      PROC_DEF_ID, PROC_DEF_KEY, CASE_STATE, 
      START_DATE, END_DATE, ASSIGN_PERSON, 
      FORM_DEF_ID, TASK_ACTION_ID, TASK_ACTION_NAME, 
      TASK_TYPE, ACTION_TYPE, TARGET_TASK_DEF_ID, 
      TARGET_ORG_TYPE, TARGET_ORG_ID)
    values (#{stepId,jdbcType=DECIMAL}, #{stepName,jdbcType=VARCHAR}, #{caseId,jdbcType=VARCHAR}, 
      #{taskInstId,jdbcType=VARCHAR}, #{taskDefId,jdbcType=VARCHAR}, #{procInstId,jdbcType=VARCHAR}, 
      #{procDefId,jdbcType=VARCHAR}, #{procDefKey,jdbcType=VARCHAR}, #{caseState,jdbcType=VARCHAR}, 
      #{startDate,jdbcType=TIMESTAMP}, #{endDate,jdbcType=TIMESTAMP}, #{assignPerson,jdbcType=VARCHAR}, 
      #{formDefId,jdbcType=DECIMAL}, #{taskActionId,jdbcType=DECIMAL}, #{taskActionName,jdbcType=VARCHAR}, 
      #{taskType,jdbcType=DECIMAL}, #{actionType,jdbcType=DECIMAL}, #{targetTaskDefId,jdbcType=VARCHAR}, 
      #{targetOrgType,jdbcType=VARCHAR}, #{targetOrgId,jdbcType=DECIMAL})
  </insert>
  <insert id="insertSelective" parameterType="com.ksource.liangfa.domain.CaseStep">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    insert into CASE_STEP
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="stepId != null">
        STEP_ID,
      </if>
      <if test="stepName != null">
        STEP_NAME,
      </if>
      <if test="caseId != null">
        CASE_ID,
      </if>
      <if test="taskInstId != null">
        TASK_INST_ID,
      </if>
      <if test="taskDefId != null">
        TASK_DEF_ID,
      </if>
      <if test="procInstId != null">
        PROC_INST_ID,
      </if>
      <if test="procDefId != null">
        PROC_DEF_ID,
      </if>
      <if test="procDefKey != null">
        PROC_DEF_KEY,
      </if>
      <if test="caseState != null">
        CASE_STATE,
      </if>
      <if test="startDate != null">
        START_DATE,
      </if>
      <if test="endDate != null">
        END_DATE,
      </if>
      <if test="assignPerson != null">
        ASSIGN_PERSON,
      </if>
      <if test="formDefId != null">
        FORM_DEF_ID,
      </if>
      <if test="taskActionId != null">
        TASK_ACTION_ID,
      </if>
      <if test="taskActionName != null">
        TASK_ACTION_NAME,
      </if>
      <if test="taskType != null">
        TASK_TYPE,
      </if>
      <if test="actionType != null">
        ACTION_TYPE,
      </if>
      <if test="targetTaskDefId != null">
        TARGET_TASK_DEF_ID,
      </if>
      <if test="targetOrgType != null">
        TARGET_ORG_TYPE,
      </if>
      <if test="targetOrgId != null">
        TARGET_ORG_ID,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="stepId != null">
        #{stepId,jdbcType=DECIMAL},
      </if>
      <if test="stepName != null">
        #{stepName,jdbcType=VARCHAR},
      </if>
      <if test="caseId != null">
        #{caseId,jdbcType=VARCHAR},
      </if>
      <if test="taskInstId != null">
        #{taskInstId,jdbcType=VARCHAR},
      </if>
      <if test="taskDefId != null">
        #{taskDefId,jdbcType=VARCHAR},
      </if>
      <if test="procInstId != null">
        #{procInstId,jdbcType=VARCHAR},
      </if>
      <if test="procDefId != null">
        #{procDefId,jdbcType=VARCHAR},
      </if>
      <if test="procDefKey != null">
        #{procDefKey,jdbcType=VARCHAR},
      </if>
      <if test="caseState != null">
        #{caseState,jdbcType=VARCHAR},
      </if>
      <if test="startDate != null">
        #{startDate,jdbcType=TIMESTAMP},
      </if>
      <if test="endDate != null">
        #{endDate,jdbcType=TIMESTAMP},
      </if>
      <if test="assignPerson != null">
        #{assignPerson,jdbcType=VARCHAR},
      </if>
      <if test="formDefId != null">
        #{formDefId,jdbcType=DECIMAL},
      </if>
      <if test="taskActionId != null">
        #{taskActionId,jdbcType=DECIMAL},
      </if>
      <if test="taskActionName != null">
        #{taskActionName,jdbcType=VARCHAR},
      </if>
      <if test="taskType != null">
        #{taskType,jdbcType=DECIMAL},
      </if>
      <if test="actionType != null">
        #{actionType,jdbcType=DECIMAL},
      </if>
      <if test="targetTaskDefId != null">
        #{targetTaskDefId,jdbcType=VARCHAR},
      </if>
      <if test="targetOrgType != null">
        #{targetOrgType,jdbcType=VARCHAR},
      </if>
      <if test="targetOrgId != null">
        #{targetOrgId,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.ksource.liangfa.domain.CaseStepExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    select count(*) from CASE_STEP
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    update CASE_STEP
    <set>
      <if test="record.stepId != null">
        STEP_ID = #{record.stepId,jdbcType=DECIMAL},
      </if>
      <if test="record.stepName != null">
        STEP_NAME = #{record.stepName,jdbcType=VARCHAR},
      </if>
      <if test="record.caseId != null">
        CASE_ID = #{record.caseId,jdbcType=VARCHAR},
      </if>
      <if test="record.taskInstId != null">
        TASK_INST_ID = #{record.taskInstId,jdbcType=VARCHAR},
      </if>
      <if test="record.taskDefId != null">
        TASK_DEF_ID = #{record.taskDefId,jdbcType=VARCHAR},
      </if>
      <if test="record.procInstId != null">
        PROC_INST_ID = #{record.procInstId,jdbcType=VARCHAR},
      </if>
      <if test="record.procDefId != null">
        PROC_DEF_ID = #{record.procDefId,jdbcType=VARCHAR},
      </if>
      <if test="record.procDefKey != null">
        PROC_DEF_KEY = #{record.procDefKey,jdbcType=VARCHAR},
      </if>
      <if test="record.caseState != null">
        CASE_STATE = #{record.caseState,jdbcType=VARCHAR},
      </if>
      <if test="record.startDate != null">
        START_DATE = #{record.startDate,jdbcType=TIMESTAMP},
      </if>
      <if test="record.endDate != null">
        END_DATE = #{record.endDate,jdbcType=TIMESTAMP},
      </if>
      <if test="record.assignPerson != null">
        ASSIGN_PERSON = #{record.assignPerson,jdbcType=VARCHAR},
      </if>
      <if test="record.formDefId != null">
        FORM_DEF_ID = #{record.formDefId,jdbcType=DECIMAL},
      </if>
      <if test="record.taskActionId != null">
        TASK_ACTION_ID = #{record.taskActionId,jdbcType=DECIMAL},
      </if>
      <if test="record.taskActionName != null">
        TASK_ACTION_NAME = #{record.taskActionName,jdbcType=VARCHAR},
      </if>
      <if test="record.taskType != null">
        TASK_TYPE = #{record.taskType,jdbcType=DECIMAL},
      </if>
      <if test="record.actionType != null">
        ACTION_TYPE = #{record.actionType,jdbcType=DECIMAL},
      </if>
      <if test="record.targetTaskDefId != null">
        TARGET_TASK_DEF_ID = #{record.targetTaskDefId,jdbcType=VARCHAR},
      </if>
      <if test="record.targetOrgType != null">
        TARGET_ORG_TYPE = #{record.targetOrgType,jdbcType=VARCHAR},
      </if>
      <if test="record.targetOrgId != null">
        TARGET_ORG_ID = #{record.targetOrgId,jdbcType=DECIMAL},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    update CASE_STEP
    set STEP_ID = #{record.stepId,jdbcType=DECIMAL},
      STEP_NAME = #{record.stepName,jdbcType=VARCHAR},
      CASE_ID = #{record.caseId,jdbcType=VARCHAR},
      TASK_INST_ID = #{record.taskInstId,jdbcType=VARCHAR},
      TASK_DEF_ID = #{record.taskDefId,jdbcType=VARCHAR},
      PROC_INST_ID = #{record.procInstId,jdbcType=VARCHAR},
      PROC_DEF_ID = #{record.procDefId,jdbcType=VARCHAR},
      PROC_DEF_KEY = #{record.procDefKey,jdbcType=VARCHAR},
      CASE_STATE = #{record.caseState,jdbcType=VARCHAR},
      START_DATE = #{record.startDate,jdbcType=TIMESTAMP},
      END_DATE = #{record.endDate,jdbcType=TIMESTAMP},
      ASSIGN_PERSON = #{record.assignPerson,jdbcType=VARCHAR},
      FORM_DEF_ID = #{record.formDefId,jdbcType=DECIMAL},
      TASK_ACTION_ID = #{record.taskActionId,jdbcType=DECIMAL},
      TASK_ACTION_NAME = #{record.taskActionName,jdbcType=VARCHAR},
      TASK_TYPE = #{record.taskType,jdbcType=DECIMAL},
      ACTION_TYPE = #{record.actionType,jdbcType=DECIMAL},
      TARGET_TASK_DEF_ID = #{record.targetTaskDefId,jdbcType=VARCHAR},
      TARGET_ORG_TYPE = #{record.targetOrgType,jdbcType=VARCHAR},
      TARGET_ORG_ID = #{record.targetOrgId,jdbcType=DECIMAL}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.ksource.liangfa.domain.CaseStep">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    update CASE_STEP
    <set>
      <if test="stepName != null">
        STEP_NAME = #{stepName,jdbcType=VARCHAR},
      </if>
      <if test="caseId != null">
        CASE_ID = #{caseId,jdbcType=VARCHAR},
      </if>
      <if test="taskInstId != null">
        TASK_INST_ID = #{taskInstId,jdbcType=VARCHAR},
      </if>
      <if test="taskDefId != null">
        TASK_DEF_ID = #{taskDefId,jdbcType=VARCHAR},
      </if>
      <if test="procInstId != null">
        PROC_INST_ID = #{procInstId,jdbcType=VARCHAR},
      </if>
      <if test="procDefId != null">
        PROC_DEF_ID = #{procDefId,jdbcType=VARCHAR},
      </if>
      <if test="procDefKey != null">
        PROC_DEF_KEY = #{procDefKey,jdbcType=VARCHAR},
      </if>
      <if test="caseState != null">
        CASE_STATE = #{caseState,jdbcType=VARCHAR},
      </if>
      <if test="startDate != null">
        START_DATE = #{startDate,jdbcType=TIMESTAMP},
      </if>
      <if test="endDate != null">
        END_DATE = #{endDate,jdbcType=TIMESTAMP},
      </if>
      <if test="assignPerson != null">
        ASSIGN_PERSON = #{assignPerson,jdbcType=VARCHAR},
      </if>
      <if test="formDefId != null">
        FORM_DEF_ID = #{formDefId,jdbcType=DECIMAL},
      </if>
      <if test="taskActionId != null">
        TASK_ACTION_ID = #{taskActionId,jdbcType=DECIMAL},
      </if>
      <if test="taskActionName != null">
        TASK_ACTION_NAME = #{taskActionName,jdbcType=VARCHAR},
      </if>
      <if test="taskType != null">
        TASK_TYPE = #{taskType,jdbcType=DECIMAL},
      </if>
      <if test="actionType != null">
        ACTION_TYPE = #{actionType,jdbcType=DECIMAL},
      </if>
      <if test="targetTaskDefId != null">
        TARGET_TASK_DEF_ID = #{targetTaskDefId,jdbcType=VARCHAR},
      </if>
      <if test="targetOrgType != null">
        TARGET_ORG_TYPE = #{targetOrgType,jdbcType=VARCHAR},
      </if>
      <if test="targetOrgId != null">
        TARGET_ORG_ID = #{targetOrgId,jdbcType=DECIMAL},
      </if>
    </set>
    where STEP_ID = #{stepId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ksource.liangfa.domain.CaseStep">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 25 11:41:55 CST 2014.
    -->
    update CASE_STEP
    set STEP_NAME = #{stepName,jdbcType=VARCHAR},
      CASE_ID = #{caseId,jdbcType=VARCHAR},
      TASK_INST_ID = #{taskInstId,jdbcType=VARCHAR},
      TASK_DEF_ID = #{taskDefId,jdbcType=VARCHAR},
      PROC_INST_ID = #{procInstId,jdbcType=VARCHAR},
      PROC_DEF_ID = #{procDefId,jdbcType=VARCHAR},
      PROC_DEF_KEY = #{procDefKey,jdbcType=VARCHAR},
      CASE_STATE = #{caseState,jdbcType=VARCHAR},
      START_DATE = #{startDate,jdbcType=TIMESTAMP},
      END_DATE = #{endDate,jdbcType=TIMESTAMP},
      ASSIGN_PERSON = #{assignPerson,jdbcType=VARCHAR},
      FORM_DEF_ID = #{formDefId,jdbcType=DECIMAL},
      TASK_ACTION_ID = #{taskActionId,jdbcType=DECIMAL},
      TASK_ACTION_NAME = #{taskActionName,jdbcType=VARCHAR},
      TASK_TYPE = #{taskType,jdbcType=DECIMAL},
      ACTION_TYPE = #{actionType,jdbcType=DECIMAL},
      TARGET_TASK_DEF_ID = #{targetTaskDefId,jdbcType=VARCHAR},
      TARGET_ORG_TYPE = #{targetOrgType,jdbcType=VARCHAR},
      TARGET_ORG_ID = #{targetOrgId,jdbcType=DECIMAL}
    where STEP_ID = #{stepId,jdbcType=DECIMAL}
  </update>
  
   <resultMap extends="BaseResultMap" id="CaseStepResultMap" type="com.ksource.liangfa.domain.CaseStep">
  	 <association column="CASE_ID" javaType="com.ksource.liangfa.domain.CaseBasic" property="caseInfo">
  	 	 <id column="CASE_ID" jdbcType="VARCHAR" property="caseId" />
	    <result column="PROC_KEY" jdbcType="VARCHAR" property="procKey" />
	    <result column="CASE_NAME" jdbcType="VARCHAR" property="caseName" />
	    <result column="CASE_NO" jdbcType="VARCHAR" property="caseNo" />
	    <result column="CASE_NATURE" jdbcType="VARCHAR" property="caseNature" />
	    <result column="CASE_DETAIL_NAME" jdbcType="VARCHAR" property="caseDetailName" />
	    <result column="UNDERTAKER" jdbcType="VARCHAR" property="undertaker" />
	    <result column="RECORD_UNIT" jdbcType="VARCHAR" property="recordUnit" />
	    <result column="RECORD_SRC" jdbcType="VARCHAR" property="recordSrc" />
	    <result column="RECORD_TIME" jdbcType="TIMESTAMP" property="recordTime" />
	    <result column="INPUTER" jdbcType="VARCHAR" property="inputer" />
	    <result column="CASE_STATE" jdbcType="VARCHAR" property="caseState" />
	    <result column="PROC_INST_ID" jdbcType="VARCHAR" property="procInstId" />
	    <result column="PROC_DEF_ID" jdbcType="VARCHAR" property="procDefId" />
	    <result column="START_TIME" jdbcType="TIMESTAMP" property="startTime" />
	    <result column="END_TIME" jdbcType="TIMESTAMP" property="endTime" />
	    <result column="LATEST_POCESS_TIME" jdbcType="TIMESTAMP" property="latestPocessTime" />
	    <result column="USER_NAME" jdbcType="VARCHAR" property="publishUserName" />
	    <result column="ORG_NAME" jdbcType="VARCHAR" property="publishOrgName" />
  	 </association>
  </resultMap>
  
  <sql id="queryFields">
	  <if test="assignPerson!= null">
       and ASSIGN_PERSON = #{assignPerson,jdbcType=DECIMAL}
      </if>
      <if test="caseInfo!=null">
      	<if test="caseInfo.caseName!=null and caseInfo.caseName!=''">
      		and case_name like concat(concat('%',#{caseInfo.caseName}),'%')
      	</if>
      	 <if test="caseInfo.caseNature!= null and caseInfo.caseNature!=''">
       		and case_nature = #{caseInfo.caseNature}
     	 </if>
      </if>
      <if test="startDate!= null and startDate!=''">
       and start_date &gt; #{startDate}
      </if>
      <if test="endDate!= null and endDate!=''">
      	and end_date &lt;= #{endDate}
      </if>
      <choose>
	      <when test="lianStartTime != null and lianEndTime != null and lian_time==null ">
	      <![CDATA[
	       		and  c.LIAN_TIME >= #{lianStartTime,jdbcType=TIMESTAMP} and c.LIAN_TIME  < (#{lianEndTime,jdbcType=TIMESTAMP} +   interval   '1'  day)
	       	]]>
	      </when>
	      <when test="lianStartTime != null and lian_time==null">
	      <![CDATA[
		      	and c.LIAN_TIME  < (#{lianEndTime,jdbcType=TIMESTAMP} +   interval   '1'  day)
		   ]]>
	      </when>
	      <when test="lianEndTime != null and lian_time==null">
	      <![CDATA[
		      	and c.LIAN_TIME >= #{lianStartTime,jdbcType=TIMESTAMP}
		  ]]>
	      </when>
     </choose>
  </sql>
  
  
  <select id="getPaginationList" parameterType="java.util.Map" resultMap="CaseStepResultMap">
		SELECT s.step_id, s.step_name, s.case_id, s.proc_inst_id,s.task_inst_id,s.start_date, s.end_date,s.assign_person,
	       c.case_name,c.proc_key,c.case_no, c.case_detail_name,c.accept_unit,
	        c.record_src,c.inputer, c.case_state, c.start_time, c.end_time,c.latest_pocess_time,
	        u.user_name ,o.org_name
	  FROM CASE_STEP s, CASE_BASIC c,USER_ u,ORGANISE o
	 WHERE u.org_id=o.org_code
	   AND s.CASE_ID = c.case_id
	   AND  c.inputer=u.user_id
	   <include refid="queryFields" />
	   order by s.end_date desc,s.case_id asc
  </select>
  
  <select id="getPaginationCount" parameterType="java.util.Map" resultType="java.lang.Integer">
  		SELECT count(*)
		  FROM CASE_STEP s, CASE_BASIC c,USER_ u,ORGANISE o
		 WHERE u.org_id=o.org_code
		   AND s.CASE_ID = c.case_id
		   AND  c.inputer=u.user_id
		  <include refid="queryFields" />
  </select>
  <!-- queryStepInfoAndProcDiagram>>> -->
  <resultMap extends="BaseResultMap" id="CaseStepAndProcDiagram_ResultMap" type="com.ksource.liangfa.domain.CaseStep">
    <result column="assign_person_name" jdbcType="VARCHAR" property="assignPersonName" />
    <result column="assign_person_org_name" jdbcType="VARCHAR" property="assignPersonOrgName" />
  	<result column="ELEMENT_ID" jdbcType="VARCHAR" property="procDiagram.elementId" />
    <result column="ELEMENT_NAME" jdbcType="VARCHAR" property="procDiagram.elementName" />
    <result column="HEIGHT" jdbcType="DECIMAL" property="procDiagram.height" />
    <result column="WIDTH" jdbcType="DECIMAL" property="procDiagram.width" />
    <result column="POINT_X" jdbcType="DECIMAL" property="procDiagram.pointX" />
    <result column="POINT_Y" jdbcType="DECIMAL" property="procDiagram.pointY" />
    <result column="POINT_X2" jdbcType="DECIMAL" property="procDiagram.pointX2" />
    <result column="POINT_Y2" jdbcType="DECIMAL" property="procDiagram.pointY2" />
  </resultMap>
  <select id="queryStepInfoAndProcDiagramByCaseId" parameterType="map" resultMap="CaseStepAndProcDiagram_ResultMap">
  	select a.*,b.*,c.user_name as assign_person_name,o.org_name as  assign_person_org_name from case_step a,proc_diagram b,user_ c,ORGANISE o
	where a.case_id=#{caseId,jdbcType=VARCHAR}
	<if test="procKey != null and procKey !='' ">
		and a.PROC_DEF_KEY=#{procKey,jdbcType=VARCHAR} 
	</if>
	and a.proc_def_id=b.proc_def_id(+)
	and a.task_def_id=b.element_id(+)
	and a.assign_person=c.user_id
	and c.org_id=o.org_code
	order by a.step_id asc
  </select>
   <select id="queryStepInfoAndDeal" parameterType="long" resultMap="CaseStepAndProcDiagram_ResultMap">
  	select a.*,c.user_name as assign_person_name,o.org_name as  assign_person_org_name from case_step a,user_ c,ORGANISE o
	where a.step_id=#{stepId}
	and a.assign_person=c.user_id
	and c.org_id=o.org_code
  </select>
   <select id="findPrevCaseInd" parameterType="string" resultType="string">
	select findPrevCaseInd('${value}') from dual
</select>
  
  	<select id="queryNoExportDataList" parameterType="map" resultMap="BaseResultMap">
		SELECT #{districtCode}||STEP_ID AS STEP_ID,STEP_NAME, #{districtCode}||CASE_ID AS CASE_ID, #{districtCode}||TASK_INST_ID AS TASK_INST_ID, TASK_DEF_ID, #{districtCode}||PROC_INST_ID AS PROC_INST_ID, PROC_DEF_ID, 
			    PROC_DEF_KEY, CASE_STATE, START_DATE, END_DATE, ASSIGN_PERSON, FORM_DEF_ID, TASK_ACTION_ID, 
			    TASK_ACTION_NAME, TASK_TYPE, ACTION_TYPE, TARGET_TASK_DEF_ID, TARGET_ORG_TYPE, TARGET_ORG_ID
		  FROM CASE_STEP 
		 WHERE EXISTS 
		       (SELECT 1 FROM CASE_MODIFIED_INFO WHERE EXP_STATE = 'N'
		       AND STEP_ID =  KEY_VALUE
		       AND TABLE_NAME = #{tableName})
	</select>  
	<resultMap type="com.ksource.liangfa.domain.CaseStep" id="getAssignPersonInfoResultMap">
		<result column="ASSIGN_PERSON_NAME" jdbcType="VARCHAR" property="assignPersonName" />
    	<result column="ASSIGN_PERSON_ORG_NAME" jdbcType="VARCHAR" property="assignPersonOrgName" />
	</resultMap>
	<!-- 案件详情展示办理人，办理时间字段 -->
	<select id="getAssignPersonInfo" parameterType="long" resultMap="getAssignPersonInfoResultMap">
		SELECT U.USER_NAME AS ASSIGN_PERSON_NAME, O.ORG_NAME AS ASSIGN_PERSON_ORG_NAME
		  FROM CASE_STEP C, USER_ U, ORGANISE O
		  WHERE C.ASSIGN_PERSON = U.USER_ID
		  AND U.ORG_ID = O.ORG_CODE
		  AND C.STEP_ID = #{stepId}
	</select>
	
	<select id="getLastCaseStep" parameterType="java.lang.String" resultMap="BaseResultMap">
	   SELECT  <include refid="Base_Column_List" /> FROM CASE_STEP S WHERE STEP_ID = (SELECT MAX(STEP_ID) FROM CASE_STEP T WHERE T.CASE_ID = #{caseId})
	</select>
	
	<resultMap id="getCaseStepListMap" type="com.ksource.liangfa.domain.CaseStep">
	    <result column="STEP_ID" jdbcType="DECIMAL" property="stepId" />
	    <result column="STEP_NAME" jdbcType="VARCHAR" property="stepName" />
	    <result column="CASE_ID" jdbcType="VARCHAR" property="caseId" />
	    <result column="TASK_INST_ID" jdbcType="VARCHAR" property="taskInstId" />
	    <result column="PROC_INST_ID" jdbcType="VARCHAR" property="procInstId" />
	    <result column="PROC_DEF_ID" jdbcType="VARCHAR" property="procDefId" />
	    <result column="CASE_STATE" jdbcType="VARCHAR" property="caseState" />
	    <result column="FORM_DEF_ID" jdbcType="DECIMAL" property="formDefId" />
  </resultMap>
	<select id="getCaseStepListByCaseId" parameterType="java.util.Map" resultMap="getCaseStepListMap">
		SELECT STEP_ID,STEP_NAME,CASE_ID,TASK_INST_ID,PROC_INST_ID,PROC_DEF_ID,CASE_STATE,FORM_DEF_ID
		FROM CASE_STEP
		WHERE 1=1
		<if test="caseId!=null">
			AND CASE_ID=#{caseId}
		</if>
		 ORDER BY STEP_ID
	</select>
</mapper>